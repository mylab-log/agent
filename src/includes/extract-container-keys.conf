# Extract `attrs`
[FILTER]
    name nest
    match container.log
    
    operation lift
    add_prefix attrs_
    nested_under attrs

# Set tag with log format
[FILTER]
    name rewrite_tag
    match container.log

    rule attrs_log_format net container.log.net false
    rule attrs_log_format mylab container.log.mylab false
    rule attrs_log_format nginx container.log.nginx false

# Remove `attrs` nested keys
[FILTER]
    name modify
    match container.log*
    
    #copy attrs_tag container
    copy attrs_tag service.name
    remove_wildcard attrs_

# Remove needless keys
[FILTER]
    name record_modifier
    match container.log*

    remove_key stream
    remove_key attrs